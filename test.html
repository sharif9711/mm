<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NutriVision AI - ìŒì‹ ì˜ì–‘ë¶„ ë¶„ì„ê¸°</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-50 to-emerald-100 min-h-screen flex flex-col items-center justify-center text-gray-800">
  <div class="w-full max-w-md bg-white rounded-2xl shadow-lg p-6 text-center">
    <h1 class="text-2xl font-bold text-emerald-700 mb-2">ğŸ± NutriVision AI</h1>
    <p class="text-sm text-gray-500 mb-4">í•¸ë“œí° ì¹´ë©”ë¼ë¡œ ìŒì‹ì„ ì°ìœ¼ë©´ AIê°€ ì˜ì–‘ì†Œë¥¼ ë¶„ì„í•©ë‹ˆë‹¤</p>

    <!-- ì¹´ë©”ë¼ ë¯¸ë¦¬ë³´ê¸° -->
    <video id="camera" autoplay playsinline class="w-full rounded-lg border border-gray-300 mb-4"></video>

    <!-- ë²„íŠ¼ -->
    <div class="flex justify-center gap-3 mb-4">
      <button id="startBtn" class="bg-emerald-600 text-white px-4 py-2 rounded-xl hover:bg-emerald-700 transition">ì¹´ë©”ë¼ ì¼œê¸°</button>
      <button id="captureBtn" class="bg-orange-500 text-white px-4 py-2 rounded-xl hover:bg-orange-600 transition">ì´¬ì˜</button>
    </div>

    <!-- ì´¬ì˜ëœ ì´ë¯¸ì§€ -->
    <canvas id="photoCanvas" class="hidden w-full rounded-lg mb-4"></canvas>

    <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
    <div id="result" class="hidden mt-4 text-left bg-emerald-50 p-4 rounded-lg">
      <h2 class="text-lg font-bold text-emerald-700 mb-2">AI ë¶„ì„ ê²°ê³¼ ğŸ½ï¸</h2>
      <p id="foodName" class="text-gray-800 font-medium mb-1"></p>
      <p id="calories" class="text-gray-700"></p>
      <p id="nutrients" class="text-gray-700"></p>
    </div>
  </div>

  <script>
    const camera = document.getElementById('camera');
    const startBtn = document.getElementById('startBtn');
    const captureBtn = document.getElementById('captureBtn');
    const canvas = document.getElementById('photoCanvas');
    const resultBox = document.getElementById('result');
    const foodName = document.getElementById('foodName');
    const calories = document.getElementById('calories');
    const nutrients = document.getElementById('nutrients');
    const ctx = canvas.getContext('2d');
    let stream;

    // ì¹´ë©”ë¼ ì‹œì‘
    startBtn.addEventListener('click', async () => {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
        camera.srcObject = stream;
      } catch (err) {
        alert("ì¹´ë©”ë¼ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤ ğŸ“¸");
      }
    });

    // ì‚¬ì§„ ì´¬ì˜
    captureBtn.addEventListener('click', () => {
      if (!stream) {
        alert("ë¨¼ì € ì¹´ë©”ë¼ë¥¼ ì¼œì£¼ì„¸ìš”!");
        return;
      }
      const videoTrack = stream.getVideoTracks()[0];
      const settings = videoTrack.getSettings();
      canvas.width = settings.width || 320;
      canvas.height = settings.height || 240;
      ctx.drawImage(camera, 0, 0, canvas.width, canvas.height);
      canvas.classList.remove('hidden');
      analyzeFood();
    });

    // AI ë¶„ì„ (ìƒ˜í”Œ ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜)
    function analyzeFood() {
      resultBox.classList.remove('hidden');
      const sampleFoods = [
        { name: "ê¹€ì¹˜ì°Œê°œ", kcal: 280, nutrients: "íƒ„ìˆ˜í™”ë¬¼ 14g / ë‹¨ë°±ì§ˆ 12g / ì§€ë°© 8g" },
        { name: "ë¹„ë¹”ë°¥", kcal: 590, nutrients: "íƒ„ìˆ˜í™”ë¬¼ 82g / ë‹¨ë°±ì§ˆ 19g / ì§€ë°© 18g" },
        { name: "ìƒëŸ¬ë“œ", kcal: 210, nutrients: "íƒ„ìˆ˜í™”ë¬¼ 10g / ë‹¨ë°±ì§ˆ 6g / ì§€ë°© 4g" },
        { name: "í”¼ì", kcal: 720, nutrients: "íƒ„ìˆ˜í™”ë¬¼ 70g / ë‹¨ë°±ì§ˆ 24g / ì§€ë°© 40g" }
      ];
      const pick = sampleFoods[Math.floor(Math.random() * sampleFoods.length)];
      foodName.textContent = `ğŸ› ìŒì‹ëª…: ${pick.name}`;
      calories.textContent = `ğŸ”¥ ì¹¼ë¡œë¦¬: ${pick.kcal} kcal`;
      nutrients.textContent = `ğŸ¥¦ ì˜ì–‘ì†Œ: ${pick.nutrients}`;
    }
  </script>
</body>
</html>
