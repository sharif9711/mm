<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NutriVision AI - 음식 영양분 분석기</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-50 to-emerald-100 min-h-screen flex flex-col items-center justify-center text-gray-800">
  <div class="w-full max-w-md bg-white rounded-2xl shadow-lg p-6 text-center">
    <h1 class="text-2xl font-bold text-emerald-700 mb-2">🍱 NutriVision AI</h1>
    <p class="text-sm text-gray-500 mb-4">핸드폰 카메라로 음식을 찍으면 AI가 영양소를 분석합니다</p>

    <!-- 카메라 미리보기 -->
    <video id="camera" autoplay playsinline class="w-full rounded-lg border border-gray-300 mb-4"></video>

    <!-- 버튼 -->
    <div class="flex justify-center gap-3 mb-4">
      <button id="startBtn" class="bg-emerald-600 text-white px-4 py-2 rounded-xl hover:bg-emerald-700 transition">카메라 켜기</button>
      <button id="captureBtn" class="bg-orange-500 text-white px-4 py-2 rounded-xl hover:bg-orange-600 transition">촬영</button>
    </div>

    <!-- 촬영된 이미지 -->
    <canvas id="photoCanvas" class="hidden w-full rounded-lg mb-4"></canvas>

    <!-- 결과 표시 영역 -->
    <div id="result" class="hidden mt-4 text-left bg-emerald-50 p-4 rounded-lg">
      <h2 class="text-lg font-bold text-emerald-700 mb-2">AI 분석 결과 🍽️</h2>
      <p id="foodName" class="text-gray-800 font-medium mb-1"></p>
      <p id="calories" class="text-gray-700"></p>
      <p id="nutrients" class="text-gray-700"></p>
    </div>
  </div>

  <script>
    const camera = document.getElementById('camera');
    const startBtn = document.getElementById('startBtn');
    const captureBtn = document.getElementById('captureBtn');
    const canvas = document.getElementById('photoCanvas');
    const resultBox = document.getElementById('result');
    const foodName = document.getElementById('foodName');
    const calories = document.getElementById('calories');
    const nutrients = document.getElementById('nutrients');
    const ctx = canvas.getContext('2d');
    let stream;

    // 카메라 시작
    startBtn.addEventListener('click', async () => {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
        camera.srcObject = stream;
      } catch (err) {
        alert("카메라 접근 권한이 필요합니다 📸");
      }
    });

    // 사진 촬영
    captureBtn.addEventListener('click', () => {
      if (!stream) {
        alert("먼저 카메라를 켜주세요!");
        return;
      }
      const videoTrack = stream.getVideoTracks()[0];
      const settings = videoTrack.getSettings();
      canvas.width = settings.width || 320;
      canvas.height = settings.height || 240;
      ctx.drawImage(camera, 0, 0, canvas.width, canvas.height);
      canvas.classList.remove('hidden');
      analyzeFood();
    });

    // AI 분석 (샘플 데이터 시뮬레이션)
    function analyzeFood() {
      resultBox.classList.remove('hidden');
      const sampleFoods = [
        { name: "김치찌개", kcal: 280, nutrients: "탄수화물 14g / 단백질 12g / 지방 8g" },
        { name: "비빔밥", kcal: 590, nutrients: "탄수화물 82g / 단백질 19g / 지방 18g" },
        { name: "샐러드", kcal: 210, nutrients: "탄수화물 10g / 단백질 6g / 지방 4g" },
        { name: "피자", kcal: 720, nutrients: "탄수화물 70g / 단백질 24g / 지방 40g" }
      ];
      const pick = sampleFoods[Math.floor(Math.random() * sampleFoods.length)];
      foodName.textContent = `🍛 음식명: ${pick.name}`;
      calories.textContent = `🔥 칼로리: ${pick.kcal} kcal`;
      nutrients.textContent = `🥦 영양소: ${pick.nutrients}`;
    }
  </script>
</body>
</html>
